<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>sctunes</title>
</head>

<body>
  {{> renderPage}}
</body>

<template name="login">
   <div class="container" style="padding-top:14%; margin-left:-4%">
      <div class="row">
         <h1 class="col-sm-4 col-sm-push-4 sctunes">scTunes</h1>
      </div>  
      <div class="row">
         <div class="col-sm-6 col-sm-push-6 desc">
            <p>Listen to your soundcloud favorites easier!</p>
         </div>
      </div> 
      <div class="row">
         <span class="col-sm-6 col-sm-push-6">
            {{> loginButtons}}
         </span>
      </div>
   </div>
</template>

<template name="sidebar">
   <div id="sidebar-wrapper">
    <ul id="playlists" class="sidebar-nav">
      <li class="sidebar-brand queue-block">
          <a id="brand-title" href="">
              scTunes
          </a> 
      </li>
    {{#if playlistMode}}
<!--        <span id="newPlaylist"><button type="button" data-toggle="modal" data-target=".newPlaylistModal">New Playlist</button></span> -->
      <li class="queue-block">
          <a href="" onclick="return false;" class="title">
              Playlists
          </a>
          <p class="description">Hold ALT, click tracks, then click</p>
          <p class="description">a playlist to add to Playlists</p>
      </li>
      <li id="favorites" class="playlistRow queue-block">
          <a id="favorites" href="" onclick="return false;">
              Favorites
          </a>
      </li>
      {{#each playlists}}
      <li id={{this.id}} class="playlistRow  queue-block">
        <a id={{this.id}} href="" onclick="return false;">
          {{this.title}}
        </a>
      </li>
      {{/each}}
    {{else}}
      <li class="queue-block">
          <a href="" onclick="return false;" class="title">
              Queue
          </a>
          <p class="description">Hold SHIFT and click tracks to</p>
          <p class="description">create a Queue</p>
      </li>
      {{#each queue}}
      <li>
        <a id="{{this.id}}-queue" href="" onclick="return false;" class="queueRow {{this.queueIndex}} {{this.qplaystatus}} col-xs-12 ">
          {{this.title}}
        </a>
      </li>
      {{/each}}
    {{/if}}
    </ul>
  </div>
</template>

<template name="app">
  <div id="wrapper">
    {{#if loggedIn}}
      {{> sidebar}}
    {{/if}}
    <div id="page-content-wrapper">
        <div class="container-fluid {{#if squares}}background{{/if}}">
          {{#if loaded}}
          <div class="row topRow">
            <span>Sort By:</span>
            <div class="btn-group">
              <button type="button" class="{{sortTypeClass}}btn btn-default dropdown-toggle" data-toggle="dropdown">
                {{sortType}} <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu">
                {{#each otherSortTypes}}
                  <li><a href="" class="{{this.className}}">{{this.type}}</a></li>
                {{/each}}
              </ul>
            </div>
            <span id="shuffle" 
                  class="">
              <button class="btn btn-default" type="button">Shuffle!</button>
            </span>
            <div id="logout"> 
              {{> loginButtons}}
            </div>
          </div>
           <div class="row">
              <div id="tracks" class="col-sm-12 {{#if currentTrack}}player-space{{/if}}">
                 {{> trackList}}
              </div>
           </div>
           {{else}}
             {{> loader}}
           {{/if}}
           {{#if currentTrack}}
             {{> player}}
           {{/if}}        
        </div> 
     {{> newPlayListModal}}
    </div>
  </div>
</template>

<template name="trackList">
  {{#if squares}}
     <div class="row text-center">
      <div class="list">
      {{#each tracks}}
      <div id={{this.id}} class="trackItem trackRow {{this.index}} square col-sm-2 col-md-4 col-lg-3 square bg {{this.playstatus}}" style="background-image:url({{this.big_artwork_url}})">
        <div class="row overlay">
          <div class="info col-xs-12">
            <span class="title">{{this.title}}</span><br>
            {{this.user.username}}
          </div>
          <span class="counts col-xs-12">
            <span class="playCount">
              <span id="playPauseIcon" class="glyphicon glyphicon-play"></span> {{this.playback_count}}
            </span>
            <span class="heartCount">
              <span id="playPauseIcon" class="glyphicon glyphicon-heart"></span> {{this.favoritings_count}}
            </span>
          </span>
        </div>
        <div class="content">
            <div class="table">
              <div class="table-cell">
              </div>
            </div>
          </div>
        </div>
      {{/each}}
      </div>
    </div>
  {{else}}
    <div class="itunes">
    {{#each tracks}}
      <div id={{this.id}} class="trackItem trackRow {{this.index}} row ">
        {{#if uploader}} 
          <span class="col-xs-8 title {{this.playstatus}}">{{this.title}}</span>
          <span class="col-xs-4 uploader {{this.playstatus}}">{{this.user.username}}</span>
        {{else}}
        {{#if artist}}
          <span class="col-xs-8 title {{this.playstatus}}">{{this.titleWithoutArtist}}</span>
          <span class="col-xs-4 uploader {{this.playstatus}}">{{this.artist}}</span>
        {{else}}
          <span class="col-xs-8 title {{this.playstatus}}">{{this.title}}</span>
          <span class="col-xs-4 uploader {{this.playstatus}}">{{this.user.username}}</span>
        {{/if}}
        {{/if}}
      </div>
    {{/each}}
    </div>
  {{/if}}
</template>

<template name="player">
    <div class="current-art player footer navbar-fixed-bottom">
      <div class="player-node col-xs-1"><img src="{{ctArt}}"></div>
      <div class="player-node col-xs-11">
        <div class="col-xs-12">
          <span class="controls">
            <span id="prevButton" class="playerControlButton">
              <span class="glyphicon glyphicon-step-backward"></span>
            </span>
            <span id="playpause" class="playerControlButton">
              <span id="playPauseIcon" class="glyphicon glyphicon-play"></span>
            </span>
            <span id="nextButton" class="playerControlButton">
              <span class="glyphicon glyphicon-step-forward"></span>
            </span>
          </span>
          <span class="player-title">{{ctTitle}} - {{ctUploader}}</span>
        </div>
      <div id="currentTrackPlayer" class="col-xs-12"></div>
      </div>
    </div>
</template>

<template name="loader">
  <div class="loading row">
    <div id="loader">
      <div id="d1"></div>
      <div id="d2"></div>
      <div id="d3"></div>
      <div id="d4"></div>
      <div id="d5"></div>
    </div>
  </div>
</template>

<template name="newPlayListModal">
  <div class="modal fade newPlaylistModal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
     <div class="modal-dialog modal-sm container">
      <div class="modal-content">
         <div class="modal-header">
           <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
           <h4 class="modal-title">New Playlist</h4>
         </div>
         <div class="modal-body">
           <form>
             Name: <input id="newName" type="text" name="name"><br>
           </form>
         </div>
         <div class="modal-footer">
           <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
           <button id="newPlaylistSubmit" type="button" class="btn btn-primary">Save changes</button>
         </div>
         <br>
      </div>
     </div>
   </div>
</template>

<template name="callback">
   <body onload="window.opener.setTimeout(window.opener.SC.connectCallback, 1)">
     <b style="width: 100%; text-align: center;">This popup should automatically close in a few seconds</b>
  </body>
</template>
